theme(legend.position = "bottom") + ggtitle("Without Gene Models (Truth)")+ scale_y_continuous(limits=c(-0.01, 1.01)) + scale_x_continuous(limits=c(-0.1, 1.01)) +
guides(shape = guide_legend(override.aes = list(size=5)),color= guide_legend(override.aes = list(size=5)))
#DENOVO
p1 <- ggplot(d[d$NumOfSpliceforms != 0 &
(d$NumOfSpliceforms %in% c(1:13) ) &
d$Aligner == "none" & d$AlignmentGenomeGuided == "false",]) +
geom_rect(aes(xmax=0.67,xmin=0,ymax=1,ymin=0),fill = rgb(1,.975,.975)) +
geom_rect(aes(xmax=1,xmin=0.67,ymax=0.25,ymin=0),fill = rgb(1,.975,.975)) +
facet_grid(. ~ SpliceEvent) +
geom_vline(xintercept=seq(0.00, 1.00, by=0.25),color="gray86",size=.5) +
geom_hline(yintercept=seq(0.00, 1.00, by=0.25),color="gray86",size=.5)+
geom_vline(xintercept=seq(0.00, 1.00, by=1/8),color="gray86",size=.1) +
geom_hline(yintercept=seq(0.00, 1.00, by=1/8),color="gray86",size=.1)+
theme_bw()+
geom_jitter(aes(x=Precision , y=Recall, color=factor(Algorithm),size =factor(NumOfSpliceforms)), position = position_jitter(height = .008,width=.008),alpha=0.95) +
#scale_shape_manual(labels=c("0-10X","10-100X","100X and more"),values=c(15,16,16,16,16,17,17,17,17,18,18,18,18),breaks=c(1,2,6,11),name="Splice Event")+
scale_color_manual(values=c("blue","red","black","darkgreen","orange","purple","turquoise1"), name="Algorithm") +
#scale_size_manual(labels=c("One splice form","Two Splice Forms","Three Splice Forms","Four Splice Forms","Five Splice Forms"),values=c(9,7,6,5,4,7,6,5,4,7,6,5,4),breaks=c(1,2,3,4,5),name="# of splice forms") +
scale_size_manual(labels=c("One splice form","Two Splice Forms","Three Splice Forms","Four Splice Forms","Five Splice Forms"),values=c(7,6,4,3,2,6,4,3,2,6,4,3,2),breaks=c(1,2,3,4,5),name="# of splice forms") +
theme(legend.position = "bottom") + ggtitle("Denovo")+ scale_y_continuous(limits=c(-0.01, 1.01)) + scale_x_continuous(limits=c(-0.1, 1.01)) +
guides(shape = guide_legend(override.aes = list(size=5)),color= guide_legend(override.aes = list(size=5)))
multiplot(p1, p2, p3,cols=1)
ggplot(d[d$NumOfSpliceforms != 0 & (d$Algorithm != "SOAP" & d$Algorithm != "Trinity" & d$Algorithm != "CEM")&
(d$NumOfSpliceforms %in% c(1:13) ) &
(d$GeneModels=="true") & d$Aligner == "Truth" & d$AlignmentGenomeGuided == "true",], aes(x=Precision , y=Recall)) +
geom_rect(aes(xmax=0.67,xmin=0,ymax=1,ymin=0),fill = rgb(1,.975,.975)) +
geom_rect(aes(xmax=1,xmin=0.67,ymax=0.25,ymin=0),fill = rgb(1,.975,.975)) +
facet_grid(. ~ SpliceEvent) +
geom_vline(xintercept=seq(0.00, 1.00, by=0.25),color="gray86",size=.5) +
geom_hline(yintercept=seq(0.00, 1.00, by=0.25),color="gray86",size=.5)+
geom_vline(xintercept=seq(0.00, 1.00, by=1/8),color="gray86",size=.1) +
geom_hline(yintercept=seq(0.00, 1.00, by=1/8),color="gray86",size=.1)+
theme_bw()+
geom_jitter(aes(x=Precision , y=Recall, color=factor(Algorithm),size =factor(NumOfSpliceforms)), position = position_jitter(height = .008,width=.008),alpha=0.95) +
#scale_shape_manual(labels=c("0-10X","10-100X","100X and more"),values=c(15,16,16,16,16,17,17,17,17,18,18,18,18),breaks=c(1,2,6,11),name="Splice Event")+
scale_color_manual(values=c("blue","red","black","darkgreen","orange","purple","turquoise1"), name="Algorithm") +
scale_size_manual(labels=c("One splice form","Two Splice Forms","Three Splice Forms","Four Splice Forms","Five Splice Forms"),values=c(7,6,4,3,2,6,4,3,2,6,4,3,2),breaks=c(1,2,3,4,5),name="# of splice forms") +
theme(legend.position = "bottom") + ggtitle("With Gene Models (Truth)")+ scale_y_continuous(limits=c(-0.01, 1.01)) + scale_x_continuous(limits=c(-0.1, 1.01)) +
guides(shape = guide_legend(override.aes = list(size=5)),color= guide_legend(override.aes = list(size=5)))
ggplot(d[d$NumOfSpliceforms != 0 & (d$Algorithm != "SOAP" & d$Algorithm != "Trinity" & d$Algorithm != "CEM")&
(d$NumOfSpliceforms %in% c(1:13) ) &
(d$GeneModels=="false") & d$Aligner == "Truth" & d$AlignmentGenomeGuided == "true",], aes(x=Precision , y=Recall)) +
geom_rect(aes(xmax=0.67,xmin=0,ymax=1,ymin=0),fill = rgb(1,.975,.975)) +
geom_rect(aes(xmax=1,xmin=0.67,ymax=0.25,ymin=0),fill = rgb(1,.975,.975)) +
facet_grid(. ~ SpliceEvent) +
geom_vline(xintercept=seq(0.00, 1.00, by=0.25),color="gray86",size=.5) +
geom_hline(yintercept=seq(0.00, 1.00, by=0.25),color="gray86",size=.5)+
geom_vline(xintercept=seq(0.00, 1.00, by=1/8),color="gray86",size=.1) +
geom_hline(yintercept=seq(0.00, 1.00, by=1/8),color="gray86",size=.1)+
theme_bw()+
geom_jitter(aes(x=Precision , y=Recall, color=factor(Algorithm),size =factor(NumOfSpliceforms)), position = position_jitter(height = .008,width=.008),alpha=0.95) +
#scale_shape_manual(labels=c("0-10X","10-100X","100X and more"),values=c(15,16,16,16,16,17,17,17,17,18,18,18,18),breaks=c(1,2,6,11),name="Splice Event")+
scale_color_manual(values=c("blue","red","black","darkgreen","orange","purple","turquoise1"), name="Algorithm") +
#scale_size_manual(labels=c("One splice form","Two Splice Forms","Three Splice Forms","Four Splice Forms","Five Splice Forms"),values=c(9,7,6,5,4,7,6,5,4,7,6,5,4),breaks=c(1,2,3,4,5),name="# of splice forms") +
scale_size_manual(labels=c("One splice form","Two Splice Forms","Three Splice Forms","Four Splice Forms","Five Splice Forms"),values=c(7,6,4,3,2,6,4,3,2,6,4,3,2),breaks=c(1,2,3,4,5),name="# of splice forms") +
theme(legend.position = "bottom") + ggtitle("Without Gene Models (Truth)")+ scale_y_continuous(limits=c(-0.01, 1.01)) + scale_x_continuous(limits=c(-0.1, 1.01)) +
guides(shape = guide_legend(override.aes = list(size=5)),color= guide_legend(override.aes = list(size=5)))
ggplot(d[d$NumOfSpliceforms != 0 & (d$Algorithm != "SOAP" & d$Algorithm != "CEM")&
(d$NumOfSpliceforms %in% c(1:13) ) &
(d$GeneModels=="false") & d$Aligner == "Truth" & d$AlignmentGenomeGuided == "true",], aes(x=Precision , y=Recall)) +
geom_rect(aes(xmax=0.67,xmin=0,ymax=1,ymin=0),fill = rgb(1,.975,.975)) +
geom_rect(aes(xmax=1,xmin=0.67,ymax=0.25,ymin=0),fill = rgb(1,.975,.975)) +
facet_grid(. ~ SpliceEvent) +
geom_vline(xintercept=seq(0.00, 1.00, by=0.25),color="gray86",size=.5) +
geom_hline(yintercept=seq(0.00, 1.00, by=0.25),color="gray86",size=.5)+
geom_vline(xintercept=seq(0.00, 1.00, by=1/8),color="gray86",size=.1) +
geom_hline(yintercept=seq(0.00, 1.00, by=1/8),color="gray86",size=.1)+
theme_bw()+
geom_jitter(aes(x=Precision , y=Recall, color=factor(Algorithm),size =factor(NumOfSpliceforms)), position = position_jitter(height = .008,width=.008),alpha=0.95) +
#scale_shape_manual(labels=c("0-10X","10-100X","100X and more"),values=c(15,16,16,16,16,17,17,17,17,18,18,18,18),breaks=c(1,2,6,11),name="Splice Event")+
#scale_color_manual(values=c("blue","red","black","darkgreen","orange","purple","turquoise1"), name="Algorithm") +
scale_color_manual(values=c("grey","blue","red","black","orange","purple","turquoise1"), name="Algorithm") +
#scale_size_manual(labels=c("One splice form","Two Splice Forms","Three Splice Forms","Four Splice Forms","Five Splice Forms"),values=c(9,7,6,5,4,7,6,5,4,7,6,5,4),breaks=c(1,2,3,4,5),name="# of splice forms") +
scale_size_manual(labels=c("One splice form","Two Splice Forms","Three Splice Forms","Four Splice Forms","Five Splice Forms"),values=c(7,6,4,3,2,6,4,3,2,6,4,3,2),breaks=c(1,2,3,4,5),name="# of splice forms") +
theme(legend.position = "bottom") + ggtitle("Without Gene Models (Truth)")+ scale_y_continuous(limits=c(-0.01, 1.01)) + scale_x_continuous(limits=c(-0.1, 1.01)) +
guides(shape = guide_legend(override.aes = list(size=5)),color= guide_legend(override.aes = list(size=5)))
ggplot(d[d$NumOfSpliceforms != 0 & (d$Algorithm != "SOAP" & d$Algorithm != "CEM")&
(d$NumOfSpliceforms %in% c(1:13) ) &
(d$GeneModels=="false") & d$Aligner == "Truth" & d$AlignmentGenomeGuided == "true",], aes(x=Precision , y=Recall)) +
geom_rect(aes(xmax=0.67,xmin=0,ymax=1,ymin=0),fill = rgb(1,.975,.975)) +
geom_rect(aes(xmax=1,xmin=0.67,ymax=0.25,ymin=0),fill = rgb(1,.975,.975)) +
facet_grid(. ~ SpliceEvent) +
geom_vline(xintercept=seq(0.00, 1.00, by=0.25),color="gray86",size=.5) +
geom_hline(yintercept=seq(0.00, 1.00, by=0.25),color="gray86",size=.5)+
geom_vline(xintercept=seq(0.00, 1.00, by=1/8),color="gray86",size=.1) +
geom_hline(yintercept=seq(0.00, 1.00, by=1/8),color="gray86",size=.1)+
theme_bw()+
geom_jitter(aes(x=Precision , y=Recall, color=factor(Algorithm),size =factor(NumOfSpliceforms)), position = position_jitter(height = .008,width=.008),alpha=0.95) +
#scale_shape_manual(labels=c("0-10X","10-100X","100X and more"),values=c(15,16,16,16,16,17,17,17,17,18,18,18,18),breaks=c(1,2,6,11),name="Splice Event")+
#scale_color_manual(values=c("blue","red","black","darkgreen","orange","purple","turquoise1"), name="Algorithm") +
scale_color_manual(values=c("grey","blue","red","black","orange","purple","turquoise1","chartreuse"), name="Algorithm") +
#scale_size_manual(labels=c("One splice form","Two Splice Forms","Three Splice Forms","Four Splice Forms","Five Splice Forms"),values=c(9,7,6,5,4,7,6,5,4,7,6,5,4),breaks=c(1,2,3,4,5),name="# of splice forms") +
scale_size_manual(labels=c("One splice form","Two Splice Forms","Three Splice Forms","Four Splice Forms","Five Splice Forms"),values=c(7,6,4,3,2,6,4,3,2,6,4,3,2),breaks=c(1,2,3,4,5),name="# of splice forms") +
theme(legend.position = "bottom") + ggtitle("Without Gene Models (Truth)")+ scale_y_continuous(limits=c(-0.01, 1.01)) + scale_x_continuous(limits=c(-0.1, 1.01)) +
guides(shape = guide_legend(override.aes = list(size=5)),color= guide_legend(override.aes = list(size=5)))
ggplot(d[d$NumOfSpliceforms != 0 &
(d$NumOfSpliceforms %in% c(1:13) ) &
d$Aligner == "none" & d$AlignmentGenomeGuided == "false",]) +
geom_rect(aes(xmax=0.67,xmin=0,ymax=1,ymin=0),fill = rgb(1,.975,.975)) +
geom_rect(aes(xmax=1,xmin=0.67,ymax=0.25,ymin=0),fill = rgb(1,.975,.975)) +
facet_grid(. ~ SpliceEvent) +
geom_vline(xintercept=seq(0.00, 1.00, by=0.25),color="gray86",size=.5) +
geom_hline(yintercept=seq(0.00, 1.00, by=0.25),color="gray86",size=.5)+
geom_vline(xintercept=seq(0.00, 1.00, by=1/8),color="gray86",size=.1) +
geom_hline(yintercept=seq(0.00, 1.00, by=1/8),color="gray86",size=.1)+
theme_bw()+
geom_jitter(aes(x=Precision , y=Recall, color=factor(Algorithm),size =factor(NumOfSpliceforms)), position = position_jitter(height = .008,width=.008),alpha=0.95) +
#scale_shape_manual(labels=c("0-10X","10-100X","100X and more"),values=c(15,16,16,16,16,17,17,17,17,18,18,18,18),breaks=c(1,2,6,11),name="Splice Event")+
scale_color_manual(values=c("blue","red","black","darkgreen","orange","purple","turquoise1"), name="Algorithm") +
#scale_size_manual(labels=c("One splice form","Two Splice Forms","Three Splice Forms","Four Splice Forms","Five Splice Forms"),values=c(9,7,6,5,4,7,6,5,4,7,6,5,4),breaks=c(1,2,3,4,5),name="# of splice forms") +
scale_size_manual(labels=c("One splice form","Two Splice Forms","Three Splice Forms","Four Splice Forms","Five Splice Forms"),values=c(7,6,4,3,2,6,4,3,2,6,4,3,2),breaks=c(1,2,3,4,5),name="# of splice forms") +
theme(legend.position = "bottom") + ggtitle("Denovo")+ scale_y_continuous(limits=c(-0.01, 1.01)) + scale_x_continuous(limits=c(-0.1, 1.01)) +
guides(shape = guide_legend(override.aes = list(size=5)),color= guide_legend(override.aes = list(size=5)))
ggplot(d[d$NumOfSpliceforms != 0 & (d$Algorithm != "SOAP" & d$Algorithm != "Trinity" & d$Algorithm != "CEM")&
(d$NumOfSpliceforms %in% c(1:13) ) &
(d$GeneModels=="true") & d$Aligner == "STAR" & d$AlignmentGenomeGuided == "true",], aes(x=Precision , y=Recall)) +
geom_rect(aes(xmax=0.67,xmin=0,ymax=1,ymin=0),fill = rgb(1,.975,.975)) +
geom_rect(aes(xmax=1,xmin=0.67,ymax=0.25,ymin=0),fill = rgb(1,.975,.975)) +
facet_grid(. ~ SpliceEvent) +
geom_vline(xintercept=seq(0.00, 1.00, by=0.25),color="gray86",size=.5) +
geom_hline(yintercept=seq(0.00, 1.00, by=0.25),color="gray86",size=.5)+
geom_vline(xintercept=seq(0.00, 1.00, by=1/8),color="gray86",size=.1) +
geom_hline(yintercept=seq(0.00, 1.00, by=1/8),color="gray86",size=.1)+
theme_bw()+
geom_jitter(aes(x=Precision , y=Recall, color=factor(Algorithm),size =factor(NumOfSpliceforms)), position = position_jitter(height = .008,width=.008),alpha=0.95) +
#scale_shape_manual(labels=c("0-10X","10-100X","100X and more"),values=c(15,16,16,16,16,17,17,17,17,18,18,18,18),breaks=c(1,2,6,11),name="Splice Event")+
scale_color_manual(values=c("blue","red","black","darkgreen","orange","purple","turquoise1"), name="Algorithm") +
scale_size_manual(labels=c("One splice form","Two Splice Forms","Three Splice Forms","Four Splice Forms","Five Splice Forms"),values=c(7,6,4,3,2,6,4,3,2,6,4,3,2),breaks=c(1,2,3,4,5),name="# of splice forms") +
theme(legend.position = "bottom") + ggtitle("With Gene Models (STAR)")+ scale_y_continuous(limits=c(-0.01, 1.01)) + scale_x_continuous(limits=c(-0.1, 1.01)) +
guides(shape = guide_legend(override.aes = list(size=5)),color= guide_legend(override.aes = list(size=5)))
ggplot(d[d$NumOfSpliceforms != 0 & (d$Algorithm != "SOAP" & d$Algorithm != "CEM")&
(d$NumOfSpliceforms %in% c(1:13) ) &
(d$GeneModels=="false") & d$Aligner == "STAR" & d$AlignmentGenomeGuided == "true",], aes(x=Precision , y=Recall)) +
geom_rect(aes(xmax=0.67,xmin=0,ymax=1,ymin=0),fill = rgb(1,.975,.975)) +
geom_rect(aes(xmax=1,xmin=0.67,ymax=0.25,ymin=0),fill = rgb(1,.975,.975)) +
facet_grid(. ~ SpliceEvent) +
geom_vline(xintercept=seq(0.00, 1.00, by=0.25),color="gray86",size=.5) +
geom_hline(yintercept=seq(0.00, 1.00, by=0.25),color="gray86",size=.5)+
geom_vline(xintercept=seq(0.00, 1.00, by=1/8),color="gray86",size=.1) +
geom_hline(yintercept=seq(0.00, 1.00, by=1/8),color="gray86",size=.1)+
theme_bw()+
geom_jitter(aes(x=Precision , y=Recall, color=factor(Algorithm),size =factor(NumOfSpliceforms)), position = position_jitter(height = .008,width=.008),alpha=0.95) +
#scale_shape_manual(labels=c("0-10X","10-100X","100X and more"),values=c(15,16,16,16,16,17,17,17,17,18,18,18,18),breaks=c(1,2,6,11),name="Splice Event")+
#scale_color_manual(values=c("blue","red","black","darkgreen","orange","purple","turquoise1"), name="Algorithm") +
scale_color_manual(values=c("grey","blue","red","black","orange","purple","turquoise1","chartreuse"), name="Algorithm") +
#scale_size_manual(labels=c("One splice form","Two Splice Forms","Three Splice Forms","Four Splice Forms","Five Splice Forms"),values=c(9,7,6,5,4,7,6,5,4,7,6,5,4),breaks=c(1,2,3,4,5),name="# of splice forms") +
scale_size_manual(labels=c("One splice form","Two Splice Forms","Three Splice Forms","Four Splice Forms","Five Splice Forms"),values=c(7,6,4,3,2,6,4,3,2,6,4,3,2),breaks=c(1,2,3,4,5),name="# of splice forms") +
theme(legend.position = "bottom") + ggtitle("Without Gene Models (STAR)")+ scale_y_continuous(limits=c(-0.01, 1.01)) + scale_x_continuous(limits=c(-0.1, 1.01)) +
guides(shape = guide_legend(override.aes = list(size=5)),color= guide_legend(override.aes = list(size=5)))
ggplot(d[d$NumOfSpliceforms != 0 & (d$Algorithm != "SOAP" & d$Algorithm != "CEM")&
(d$NumOfSpliceforms %in% c(1:13) ) &
(d$GeneModels=="false") & d$Aligner == "STAR" & d$AlignmentGenomeGuided == "true",], aes(x=Precision , y=Recall)) +
geom_rect(aes(xmax=0.67,xmin=0,ymax=1,ymin=0),fill = rgb(1,.975,.975)) +
geom_rect(aes(xmax=1,xmin=0.67,ymax=0.25,ymin=0),fill = rgb(1,.975,.975)) +
facet_grid(. ~ SpliceEvent) +
geom_vline(xintercept=seq(0.00, 1.00, by=0.25),color="gray86",size=.5) +
geom_hline(yintercept=seq(0.00, 1.00, by=0.25),color="gray86",size=.5)+
geom_vline(xintercept=seq(0.00, 1.00, by=1/8),color="gray86",size=.1) +
geom_hline(yintercept=seq(0.00, 1.00, by=1/8),color="gray86",size=.1)+
theme_bw()+
geom_jitter(aes(x=Precision , y=Recall, color=factor(Algorithm),size =factor(NumOfSpliceforms)), position = position_jitter(height = .008,width=.008),alpha=0.95) +
#scale_shape_manual(labels=c("0-10X","10-100X","100X and more"),values=c(15,16,16,16,16,17,17,17,17,18,18,18,18),breaks=c(1,2,6,11),name="Splice Event")+
#scale_color_manual(values=c("blue","red","black","darkgreen","orange","purple","turquoise1"), name="Algorithm") +
scale_color_manual(values=c("grey","blue","red","black","orange","purple","turquoise1","chartreuse"), name="Algorithm") +
#scale_size_manual(labels=c("One splice form","Two Splice Forms","Three Splice Forms","Four Splice Forms","Five Splice Forms"),values=c(9,7,6,5,4,7,6,5,4,7,6,5,4),breaks=c(1,2,3,4,5),name="# of splice forms") +
scale_size_manual(labels=c("One splice form","Two Splice Forms","Three Splice Forms","Four Splice Forms","Five Splice Forms"),values=c(7,6,4,3,2,6,4,3,2,6,4,3,2),breaks=c(1,2,3,4,5),name="# of splice forms") +
theme(legend.position = "bottom") + ggtitle("Without Gene Models (STAR)")+ scale_y_continuous(limits=c(-0.01, 1.01)) + scale_x_continuous(limits=c(-0.1, 1.01)) +
guides(shape = guide_legend(override.aes = list(size=5)),color= guide_legend(override.aes = list(size=5)))
ggplot(d[d$NumOfSpliceforms != 0 & (d$Algorithm != "SOAP" & d$Algorithm != "CEM")&
(d$NumOfSpliceforms %in% c(1:13) ) &
(d$GeneModels=="false") & d$Aligner == "STAR"], aes(x=Precision , y=Recall)) +
geom_rect(aes(xmax=0.67,xmin=0,ymax=1,ymin=0),fill = rgb(1,.975,.975)) +
geom_rect(aes(xmax=1,xmin=0.67,ymax=0.25,ymin=0),fill = rgb(1,.975,.975)) +
facet_grid(. ~ SpliceEvent) +
geom_vline(xintercept=seq(0.00, 1.00, by=0.25),color="gray86",size=.5) +
geom_hline(yintercept=seq(0.00, 1.00, by=0.25),color="gray86",size=.5)+
geom_vline(xintercept=seq(0.00, 1.00, by=1/8),color="gray86",size=.1) +
geom_hline(yintercept=seq(0.00, 1.00, by=1/8),color="gray86",size=.1)+
theme_bw()+
geom_jitter(aes(x=Precision , y=Recall, color=factor(Algorithm),size =factor(NumOfSpliceforms)), position = position_jitter(height = .008,width=.008),alpha=0.95) +
#scale_shape_manual(labels=c("0-10X","10-100X","100X and more"),values=c(15,16,16,16,16,17,17,17,17,18,18,18,18),breaks=c(1,2,6,11),name="Splice Event")+
#scale_color_manual(values=c("blue","red","black","darkgreen","orange","purple","turquoise1"), name="Algorithm") +
scale_color_manual(values=c("grey","blue","red","black","orange","purple","turquoise1","chartreuse"), name="Algorithm") +
#scale_size_manual(labels=c("One splice form","Two Splice Forms","Three Splice Forms","Four Splice Forms","Five Splice Forms"),values=c(9,7,6,5,4,7,6,5,4,7,6,5,4),breaks=c(1,2,3,4,5),name="# of splice forms") +
scale_size_manual(labels=c("One splice form","Two Splice Forms","Three Splice Forms","Four Splice Forms","Five Splice Forms"),values=c(7,6,4,3,2,6,4,3,2,6,4,3,2),breaks=c(1,2,3,4,5),name="# of splice forms") +
theme(legend.position = "bottom") + ggtitle("Without Gene Models (STAR)")+ scale_y_continuous(limits=c(-0.01, 1.01)) + scale_x_continuous(limits=c(-0.1, 1.01)) +
guides(shape = guide_legend(override.aes = list(size=5)),color= guide_legend(override.aes = list(size=5)))
ggplot(d[d$NumOfSpliceforms != 0 & (d$Algorithm != "SOAP" & d$Algorithm != "CEM")&
(d$NumOfSpliceforms %in% c(1:13) ) &
(d$GeneModels=="false") & d$Aligner == "STAR",], aes(x=Precision , y=Recall)) +
geom_rect(aes(xmax=0.67,xmin=0,ymax=1,ymin=0),fill = rgb(1,.975,.975)) +
geom_rect(aes(xmax=1,xmin=0.67,ymax=0.25,ymin=0),fill = rgb(1,.975,.975)) +
facet_grid(. ~ SpliceEvent) +
geom_vline(xintercept=seq(0.00, 1.00, by=0.25),color="gray86",size=.5) +
geom_hline(yintercept=seq(0.00, 1.00, by=0.25),color="gray86",size=.5)+
geom_vline(xintercept=seq(0.00, 1.00, by=1/8),color="gray86",size=.1) +
geom_hline(yintercept=seq(0.00, 1.00, by=1/8),color="gray86",size=.1)+
theme_bw()+
geom_jitter(aes(x=Precision , y=Recall, color=factor(Algorithm),size =factor(NumOfSpliceforms)), position = position_jitter(height = .008,width=.008),alpha=0.95) +
#scale_shape_manual(labels=c("0-10X","10-100X","100X and more"),values=c(15,16,16,16,16,17,17,17,17,18,18,18,18),breaks=c(1,2,6,11),name="Splice Event")+
#scale_color_manual(values=c("blue","red","black","darkgreen","orange","purple","turquoise1"), name="Algorithm") +
scale_color_manual(values=c("grey","blue","red","black","orange","purple","turquoise1","chartreuse"), name="Algorithm") +
#scale_size_manual(labels=c("One splice form","Two Splice Forms","Three Splice Forms","Four Splice Forms","Five Splice Forms"),values=c(9,7,6,5,4,7,6,5,4,7,6,5,4),breaks=c(1,2,3,4,5),name="# of splice forms") +
scale_size_manual(labels=c("One splice form","Two Splice Forms","Three Splice Forms","Four Splice Forms","Five Splice Forms"),values=c(7,6,4,3,2,6,4,3,2,6,4,3,2),breaks=c(1,2,3,4,5),name="# of splice forms") +
theme(legend.position = "bottom") + ggtitle("Without Gene Models (STAR)")+ scale_y_continuous(limits=c(-0.01, 1.01)) + scale_x_continuous(limits=c(-0.1, 1.01)) +
guides(shape = guide_legend(override.aes = list(size=5)),color= guide_legend(override.aes = list(size=5)))
head(d)
tail(d)
d
ggplot(d[d$NumOfSpliceforms != 0 & (d$Algorithm != "SOAP" & d$Algorithm != "Trinity" & d$Algorithm != "CEM")&
(d$NumOfSpliceforms %in% c(1:13) ) &
(d$GeneModels=="true") & d$Aligner == "TopHat2" & d$AlignmentGenomeGuided == "true",], aes(x=Precision , y=Recall)) +
geom_rect(aes(xmax=0.67,xmin=0,ymax=1,ymin=0),fill = rgb(1,.975,.975)) +
geom_rect(aes(xmax=1,xmin=0.67,ymax=0.25,ymin=0),fill = rgb(1,.975,.975)) +
facet_grid(. ~ SpliceEvent) +
geom_vline(xintercept=seq(0.00, 1.00, by=0.25),color="gray86",size=.5) +
geom_hline(yintercept=seq(0.00, 1.00, by=0.25),color="gray86",size=.5)+
geom_vline(xintercept=seq(0.00, 1.00, by=1/8),color="gray86",size=.1) +
geom_hline(yintercept=seq(0.00, 1.00, by=1/8),color="gray86",size=.1)+
theme_bw()+
geom_jitter(aes(x=Precision , y=Recall, color=factor(Algorithm),size =factor(NumOfSpliceforms)), position = position_jitter(height = .008,width=.008),alpha=0.95) +
#scale_shape_manual(labels=c("0-10X","10-100X","100X and more"),values=c(15,16,16,16,16,17,17,17,17,18,18,18,18),breaks=c(1,2,6,11),name="Splice Event")+
scale_color_manual(values=c("blue","red","black","darkgreen","orange","purple","turquoise1"), name="Algorithm") +
scale_size_manual(labels=c("One splice form","Two Splice Forms","Three Splice Forms","Four Splice Forms","Five Splice Forms"),values=c(7,6,4,3,2,6,4,3,2,6,4,3,2),breaks=c(1,2,3,4,5),name="# of splice forms") +
theme(legend.position = "bottom") + ggtitle("With Gene Models (TopHat2)")+ scale_y_continuous(limits=c(-0.01, 1.01)) + scale_x_continuous(limits=c(-0.1, 1.01)) +
guides(shape = guide_legend(override.aes = list(size=5)),color= guide_legend(override.aes = list(size=5)))
ggplot(d[d$NumOfSpliceforms != 0 & (d$Algorithm != "SOAP" & d$Algorithm != "CEM")&
(d$NumOfSpliceforms %in% c(1:13) ) &
(d$GeneModels=="false") & d$Aligner == "TopHat2",], aes(x=Precision , y=Recall)) +
geom_rect(aes(xmax=0.67,xmin=0,ymax=1,ymin=0),fill = rgb(1,.975,.975)) +
geom_rect(aes(xmax=1,xmin=0.67,ymax=0.25,ymin=0),fill = rgb(1,.975,.975)) +
facet_grid(. ~ SpliceEvent) +
geom_vline(xintercept=seq(0.00, 1.00, by=0.25),color="gray86",size=.5) +
geom_hline(yintercept=seq(0.00, 1.00, by=0.25),color="gray86",size=.5)+
geom_vline(xintercept=seq(0.00, 1.00, by=1/8),color="gray86",size=.1) +
geom_hline(yintercept=seq(0.00, 1.00, by=1/8),color="gray86",size=.1)+
theme_bw()+
geom_jitter(aes(x=Precision , y=Recall, color=factor(Algorithm),size =factor(NumOfSpliceforms)), position = position_jitter(height = .008,width=.008),alpha=0.95) +
#scale_shape_manual(labels=c("0-10X","10-100X","100X and more"),values=c(15,16,16,16,16,17,17,17,17,18,18,18,18),breaks=c(1,2,6,11),name="Splice Event")+
#scale_color_manual(values=c("blue","red","black","darkgreen","orange","purple","turquoise1"), name="Algorithm") +
scale_color_manual(values=c("grey","blue","red","black","orange","purple","turquoise1","chartreuse"), name="Algorithm") +
#scale_size_manual(labels=c("One splice form","Two Splice Forms","Three Splice Forms","Four Splice Forms","Five Splice Forms"),values=c(9,7,6,5,4,7,6,5,4,7,6,5,4),breaks=c(1,2,3,4,5),name="# of splice forms") +
scale_size_manual(labels=c("One splice form","Two Splice Forms","Three Splice Forms","Four Splice Forms","Five Splice Forms"),values=c(7,6,4,3,2,6,4,3,2,6,4,3,2),breaks=c(1,2,3,4,5),name="# of splice forms") +
theme(legend.position = "bottom") + ggtitle("Without Gene Models (TopHat2)")+ scale_y_continuous(limits=c(-0.01, 1.01)) + scale_x_continuous(limits=c(-0.1, 1.01)) +
guides(shape = guide_legend(override.aes = list(size=5)),color= guide_legend(override.aes = list(size=5)))
cols <- c('character','character','character','character','character', 'integer','integer','integer','character',
'numeric','numeric', 'character')
d = read.csv("results_combined.txt",header = T,sep = "\t",na.strings = "NaN",colClasses = cols)
d$DataSet[d$DataSet == "EnsemblDirty"] = "EnsemblRealistic"
d$DataSet[d$DataSet == "EnsemblClean"] = "EnsemblPerfect"
ggplot(d[d$NumOfSpliceforms %in% c(0:2) &
(d$GeneModels=="true") & d$Aligner == "Truth" & d$AlignmentGenomeGuided == "true",], aes(x=Precision , y=Recall)) +
geom_rect(aes(xmax=0.67,xmin=0,ymax=1,ymin=0),fill = rgb(1,.975,.975)) +
geom_rect(aes(xmax=1,xmin=0.67,ymax=0.25,ymin=0),fill = rgb(1,.975,.975)) +
facet_grid(. ~ DataSet) +
geom_vline(xintercept=seq(0.00, 1.00, by=0.25),color="gray86",size=.5) +
geom_hline(yintercept=seq(0.00, 1.00, by=0.25),color="gray86",size=.5)+
geom_vline(xintercept=seq(0.00, 1.00, by=1/8),color="gray86",size=.1) +
geom_hline(yintercept=seq(0.00, 1.00, by=1/8),color="gray86",size=.1)+
theme_bw()+
geom_jitter(aes(x=Precision , y=Recall, color=factor(Algorithm),size =factor(NumOfSpliceforms)), position = position_jitter(height = .008,width=.008),alpha=0.95) +
#scale_shape_manual(labels=c("0-10X","10-100X","100X and more"),values=c(15,16,16,16,16,17,17,17,17,18,18,18,18),breaks=c(1,2,6,11),name="Splice Event")+
scale_color_manual(values=c("blue","red","black","darkgreen","orange","purple","turquoise1"), name="Algorithm") +
scale_size_manual(labels=c("1-10X","10-100X","100X and more"),values=c(3,5,7),breaks=c(0,1,2),name="X coverage") +
theme(legend.position = "bottom") + ggtitle("With Gene Models (Truth)")+ scale_y_continuous(limits=c(-0.01, 1.01)) + scale_x_continuous(limits=c(-0.1, 1.01)) +
guides(shape = guide_legend(override.aes = list(size=5)),color= guide_legend(override.aes = list(size=5)))
ggplot(d[d$NumOfSpliceforms %in% c(0:2) &
(d$GeneModels=="false") & d$Aligner == "Truth" & d$AlignmentGenomeGuided == "true",]) +
geom_rect(aes(xmax=0.67,xmin=0,ymax=1,ymin=0),fill = rgb(1,.975,.975)) +
geom_rect(aes(xmax=1,xmin=0.67,ymax=0.25,ymin=0),fill = rgb(1,.975,.975)) +
facet_grid(. ~ DataSet) +
geom_vline(xintercept=seq(0.00, 1.00, by=0.25),color="gray86",size=.5) +
geom_hline(yintercept=seq(0.00, 1.00, by=0.25),color="gray86",size=.5)+
geom_vline(xintercept=seq(0.00, 1.00, by=1/8),color="gray86",size=.1) +
geom_hline(yintercept=seq(0.00, 1.00, by=1/8),color="gray86",size=.1)+
theme_bw()+
geom_jitter(aes(x=Precision , y=Recall, color=factor(Algorithm),size =factor(NumOfSpliceforms)), position = position_jitter(height = .008,width=.008),alpha=0.95) +
#scale_shape_manual(labels=c("0-10X","10-100X","100X and more"),values=c(15,16,16,16,16,17,17,17,17,18,18,18,18),breaks=c(1,2,6,11),name="Splice Event")+
scale_color_manual(values=c("grey","blue","red","black","orange","purple","turquoise1","chartreuse"), name="Algorithm") +
scale_size_manual(labels=c("1-10X","10-100X","100X and more"),values=c(3,5,7),breaks=c(0,1,2),name="X coverage") +
theme(legend.position = "bottom") + ggtitle("Without Gene Models (Truth)")+ scale_y_continuous(limits=c(-0.01, 1.01)) + scale_x_continuous(limits=c(-0.1, 1.01)) +
guides(shape = guide_legend(override.aes = list(size=5)),color= guide_legend(override.aes = list(size=5)))
ggplot(d[d$NumOfSpliceforms %in% c(0:2) &
d$Aligner == "none" & d$AlignmentGenomeGuided == "false",]) +
geom_rect(aes(xmax=0.67,xmin=0,ymax=1,ymin=0),fill = rgb(1,.975,.975)) +
geom_rect(aes(xmax=1,xmin=0.67,ymax=0.25,ymin=0),fill = rgb(1,.975,.975)) +
facet_grid(. ~ DataSet) +
geom_vline(xintercept=seq(0.00, 1.00, by=0.25),color="gray86",size=.5) +
geom_hline(yintercept=seq(0.00, 1.00, by=0.25),color="gray86",size=.5)+
geom_vline(xintercept=seq(0.00, 1.00, by=1/8),color="gray86",size=.1) +
geom_hline(yintercept=seq(0.00, 1.00, by=1/8),color="gray86",size=.1)+
theme_bw()+
geom_jitter(aes(x=Precision , y=Recall, color=factor(Algorithm),size =factor(NumOfSpliceforms)), position = position_jitter(height = .008,width=.008),alpha=0.95) +
#scale_shape_manual(labels=c("0-10X","10-100X","100X and more"),values=c(15,16,16,16,16,17,17,17,17,18,18,18,18),breaks=c(1,2,6,11),name="Splice Event")+
scale_color_manual(values=c("blue","red","black","darkgreen","orange","brown"), name="Algorithm") +
scale_size_manual(labels=c("1-10X","10-100X","100X and more"),values=c(3,5,7),breaks=c(0,1,2),name="X coverage") +
theme(legend.position = "bottom") + ggtitle("Denovo")+ scale_y_continuous(limits=c(-0.01, 1.01)) + scale_x_continuous(limits=c(-0.1, 1.01)) +
guides(shape = guide_legend(override.aes = list(size=5)),color= guide_legend(override.aes = list(size=5)))
cols <- c('character','character','character','character','character', 'numeric','numeric','integer','character',
'numeric','numeric', 'character')
d = read.csv("results.txt",header = T,sep = "\t",colClasses = cols)
ggplot(d[d$NumOfSpliceforms != 0 &
(d$NumOfSpliceforms %in% c(1:13) ) &
d$Aligner == "none" & d$AlignmentGenomeGuided == "false",]) +
geom_rect(aes(xmax=0.67,xmin=0,ymax=1,ymin=0),fill = rgb(1,.975,.975)) +
geom_rect(aes(xmax=1,xmin=0.67,ymax=0.25,ymin=0),fill = rgb(1,.975,.975)) +
facet_grid(. ~ SpliceEvent) +
geom_vline(xintercept=seq(0.00, 1.00, by=0.25),color="gray86",size=.5) +
geom_hline(yintercept=seq(0.00, 1.00, by=0.25),color="gray86",size=.5)+
geom_vline(xintercept=seq(0.00, 1.00, by=1/8),color="gray86",size=.1) +
geom_hline(yintercept=seq(0.00, 1.00, by=1/8),color="gray86",size=.1)+
theme_bw()+
geom_jitter(aes(x=Precision , y=Recall, color=factor(Algorithm),size =factor(NumOfSpliceforms)), position = position_jitter(height = .008,width=.008),alpha=0.95) +
#scale_shape_manual(labels=c("0-10X","10-100X","100X and more"),values=c(15,16,16,16,16,17,17,17,17,18,18,18,18),breaks=c(1,2,6,11),name="Splice Event")+
scale_color_manual(values=c("blue","red","black","darkgreen","orange","purple","turquoise1"), name="Algorithm") +
#scale_size_manual(labels=c("One splice form","Two Splice Forms","Three Splice Forms","Four Splice Forms","Five Splice Forms"),values=c(9,7,6,5,4,7,6,5,4,7,6,5,4),breaks=c(1,2,3,4,5),name="# of splice forms") +
scale_size_manual(labels=c("One splice form","Two Splice Forms","Three Splice Forms","Four Splice Forms","Five Splice Forms"),values=c(7,6,4,3,2,6,4,3,2,6,4,3,2),breaks=c(1,2,3,4,5),name="# of splice forms") +
theme(legend.position = "bottom") + ggtitle("Denovo")+ scale_y_continuous(limits=c(-0.01, 1.01)) + scale_x_continuous(limits=c(-0.1, 1.01)) +
guides(shape = guide_legend(override.aes = list(size=5)),color= guide_legend(override.aes = list(size=5)))
cols <- c('character','character','character','character','character', 'integer','integer','integer','character',
'numeric','numeric', 'character')
d = read.csv("results_combined.txt",header = T,sep = "\t",na.strings = "NaN",colClasses = cols)
d$DataSet[d$DataSet == "EnsemblDirty"] = "EnsemblRealistic"
d$DataSet[d$DataSet == "EnsemblClean"] = "EnsemblPerfect"
ggplot(d[d$NumOfSpliceforms %in% c(0:2) &
(d$GeneModels=="true") & d$Aligner == "STAR" & d$AlignmentGenomeGuided == "true",], aes(x=Precision , y=Recall)) +
geom_rect(aes(xmax=0.67,xmin=0,ymax=1,ymin=0),fill = rgb(1,.975,.975)) +
geom_rect(aes(xmax=1,xmin=0.67,ymax=0.25,ymin=0),fill = rgb(1,.975,.975)) +
facet_grid(. ~ DataSet) +
geom_vline(xintercept=seq(0.00, 1.00, by=0.25),color="gray86",size=.5) +
geom_hline(yintercept=seq(0.00, 1.00, by=0.25),color="gray86",size=.5)+
geom_vline(xintercept=seq(0.00, 1.00, by=1/8),color="gray86",size=.1) +
geom_hline(yintercept=seq(0.00, 1.00, by=1/8),color="gray86",size=.1)+
theme_bw()+
geom_jitter(aes(x=Precision , y=Recall, color=factor(Algorithm),size =factor(NumOfSpliceforms)), position = position_jitter(height = .008,width=.008),alpha=0.95) +
#scale_shape_manual(labels=c("0-10X","10-100X","100X and more"),values=c(15,16,16,16,16,17,17,17,17,18,18,18,18),breaks=c(1,2,6,11),name="Splice Event")+
scale_color_manual(values=c("blue","red","black","darkgreen","orange","purple","turquoise1"), name="Algorithm") +
scale_size_manual(labels=c("1-10X","10-100X","100X and more"),values=c(3,5,7),breaks=c(0,1,2),name="X coverage") +
theme(legend.position = "bottom") + ggtitle("With Gene Models (STAR)")+ scale_y_continuous(limits=c(-0.01, 1.01)) + scale_x_continuous(limits=c(-0.1, 1.01)) +
guides(shape = guide_legend(override.aes = list(size=5)),color= guide_legend(override.aes = list(size=5)))
ggplot(d[d$NumOfSpliceforms %in% c(0:2) &
(d$GeneModels=="false") & d$Aligner == "STAR" & d$AlignmentGenomeGuided == "true",]) +
geom_rect(aes(xmax=0.67,xmin=0,ymax=1,ymin=0),fill = rgb(1,.975,.975)) +
geom_rect(aes(xmax=1,xmin=0.67,ymax=0.25,ymin=0),fill = rgb(1,.975,.975)) +
facet_grid(. ~ DataSet) +
geom_vline(xintercept=seq(0.00, 1.00, by=0.25),color="gray86",size=.5) +
geom_hline(yintercept=seq(0.00, 1.00, by=0.25),color="gray86",size=.5)+
geom_vline(xintercept=seq(0.00, 1.00, by=1/8),color="gray86",size=.1) +
geom_hline(yintercept=seq(0.00, 1.00, by=1/8),color="gray86",size=.1)+
theme_bw()+
geom_jitter(aes(x=Precision , y=Recall, color=factor(Algorithm),size =factor(NumOfSpliceforms)), position = position_jitter(height = .008,width=.008),alpha=0.95) +
#scale_shape_manual(labels=c("0-10X","10-100X","100X and more"),values=c(15,16,16,16,16,17,17,17,17,18,18,18,18),breaks=c(1,2,6,11),name="Splice Event")+
scale_color_manual(values=c("grey","blue","red","black","orange","purple","turquoise1","chartreuse"), name="Algorithm") +
scale_size_manual(labels=c("1-10X","10-100X","100X and more"),values=c(3,5,7),breaks=c(0,1,2),name="X coverage") +
theme(legend.position = "bottom") + ggtitle("Without Gene Models (STAR)")+ scale_y_continuous(limits=c(-0.01, 1.01)) + scale_x_continuous(limits=c(-0.1, 1.01)) +
guides(shape = guide_legend(override.aes = list(size=5)),color= guide_legend(override.aes = list(size=5)))
ggplot(d[d$NumOfSpliceforms %in% c(0:2) &
(d$GeneModels=="false") & d$Aligner == "STAR" ,]) +
geom_rect(aes(xmax=0.67,xmin=0,ymax=1,ymin=0),fill = rgb(1,.975,.975)) +
geom_rect(aes(xmax=1,xmin=0.67,ymax=0.25,ymin=0),fill = rgb(1,.975,.975)) +
facet_grid(. ~ DataSet) +
geom_vline(xintercept=seq(0.00, 1.00, by=0.25),color="gray86",size=.5) +
geom_hline(yintercept=seq(0.00, 1.00, by=0.25),color="gray86",size=.5)+
geom_vline(xintercept=seq(0.00, 1.00, by=1/8),color="gray86",size=.1) +
geom_hline(yintercept=seq(0.00, 1.00, by=1/8),color="gray86",size=.1)+
theme_bw()+
geom_jitter(aes(x=Precision , y=Recall, color=factor(Algorithm),size =factor(NumOfSpliceforms)), position = position_jitter(height = .008,width=.008),alpha=0.95) +
#scale_shape_manual(labels=c("0-10X","10-100X","100X and more"),values=c(15,16,16,16,16,17,17,17,17,18,18,18,18),breaks=c(1,2,6,11),name="Splice Event")+
scale_color_manual(values=c("grey","blue","red","black","orange","purple","turquoise1","chartreuse"), name="Algorithm") +
scale_size_manual(labels=c("1-10X","10-100X","100X and more"),values=c(3,5,7),breaks=c(0,1,2),name="X coverage") +
theme(legend.position = "bottom") + ggtitle("Without Gene Models (STAR)")+ scale_y_continuous(limits=c(-0.01, 1.01)) + scale_x_continuous(limits=c(-0.1, 1.01)) +
guides(shape = guide_legend(override.aes = list(size=5)),color= guide_legend(override.aes = list(size=5)))
ggplot(d[d$NumOfSpliceforms %in% c(0:2) &
(d$GeneModels=="true") & d$Aligner == "TopHat2" & d$AlignmentGenomeGuided == "true",], aes(x=Precision , y=Recall)) +
geom_rect(aes(xmax=0.67,xmin=0,ymax=1,ymin=0),fill = rgb(1,.975,.975)) +
geom_rect(aes(xmax=1,xmin=0.67,ymax=0.25,ymin=0),fill = rgb(1,.975,.975)) +
facet_grid(. ~ DataSet) +
geom_vline(xintercept=seq(0.00, 1.00, by=0.25),color="gray86",size=.5) +
geom_hline(yintercept=seq(0.00, 1.00, by=0.25),color="gray86",size=.5)+
geom_vline(xintercept=seq(0.00, 1.00, by=1/8),color="gray86",size=.1) +
geom_hline(yintercept=seq(0.00, 1.00, by=1/8),color="gray86",size=.1)+
theme_bw()+
geom_jitter(aes(x=Precision , y=Recall, color=factor(Algorithm),size =factor(NumOfSpliceforms)), position = position_jitter(height = .008,width=.008),alpha=0.95) +
#scale_shape_manual(labels=c("0-10X","10-100X","100X and more"),values=c(15,16,16,16,16,17,17,17,17,18,18,18,18),breaks=c(1,2,6,11),name="Splice Event")+
scale_color_manual(values=c("blue","red","black","darkgreen","orange","purple","turquoise1"), name="Algorithm") +
scale_size_manual(labels=c("1-10X","10-100X","100X and more"),values=c(3,5,7),breaks=c(0,1,2),name="X coverage") +
theme(legend.position = "bottom") + ggtitle("With Gene Models (TopHat2)")+ scale_y_continuous(limits=c(-0.01, 1.01)) + scale_x_continuous(limits=c(-0.1, 1.01)) +
guides(shape = guide_legend(override.aes = list(size=5)),color= guide_legend(override.aes = list(size=5)))
ggplot(d[d$NumOfSpliceforms %in% c(0:2) &
(d$GeneModels=="false") & d$Aligner == "TopHat2" ,]) +
geom_rect(aes(xmax=0.67,xmin=0,ymax=1,ymin=0),fill = rgb(1,.975,.975)) +
geom_rect(aes(xmax=1,xmin=0.67,ymax=0.25,ymin=0),fill = rgb(1,.975,.975)) +
facet_grid(. ~ DataSet) +
geom_vline(xintercept=seq(0.00, 1.00, by=0.25),color="gray86",size=.5) +
geom_hline(yintercept=seq(0.00, 1.00, by=0.25),color="gray86",size=.5)+
geom_vline(xintercept=seq(0.00, 1.00, by=1/8),color="gray86",size=.1) +
geom_hline(yintercept=seq(0.00, 1.00, by=1/8),color="gray86",size=.1)+
theme_bw()+
geom_jitter(aes(x=Precision , y=Recall, color=factor(Algorithm),size =factor(NumOfSpliceforms)), position = position_jitter(height = .008,width=.008),alpha=0.95) +
#scale_shape_manual(labels=c("0-10X","10-100X","100X and more"),values=c(15,16,16,16,16,17,17,17,17,18,18,18,18),breaks=c(1,2,6,11),name="Splice Event")+
scale_color_manual(values=c("grey","blue","red","black","orange","purple","turquoise1","chartreuse"), name="Algorithm") +
scale_size_manual(labels=c("1-10X","10-100X","100X and more"),values=c(3,5,7),breaks=c(0,1,2),name="X coverage") +
theme(legend.position = "bottom") + ggtitle("Without Gene Models (TopHat2)")+ scale_y_continuous(limits=c(-0.01, 1.01)) + scale_x_continuous(limits=c(-0.1, 1.01)) +
guides(shape = guide_legend(override.aes = list(size=5)),color= guide_legend(override.aes = list(size=5)))
ggplot(d[d$NumOfSpliceforms %in% c(0:2) &
(d$GeneModels=="true") & d$Aligner == "TopHat2" & d$AlignmentGenomeGuided == "true",], aes(x=Precision , y=Recall)) +
geom_rect(aes(xmax=0.67,xmin=0,ymax=1,ymin=0),fill = rgb(1,.975,.975)) +
geom_rect(aes(xmax=1,xmin=0.67,ymax=0.25,ymin=0),fill = rgb(1,.975,.975)) +
facet_grid(. ~ DataSet) +
geom_vline(xintercept=seq(0.00, 1.00, by=0.25),color="gray86",size=.5) +
geom_hline(yintercept=seq(0.00, 1.00, by=0.25),color="gray86",size=.5)+
geom_vline(xintercept=seq(0.00, 1.00, by=1/8),color="gray86",size=.1) +
geom_hline(yintercept=seq(0.00, 1.00, by=1/8),color="gray86",size=.1)+
theme_bw()+
geom_jitter(aes(x=Precision , y=Recall, color=factor(Algorithm),size =factor(NumOfSpliceforms)), position = position_jitter(height = .008,width=.008),alpha=0.95) +
#scale_shape_manual(labels=c("0-10X","10-100X","100X and more"),values=c(15,16,16,16,16,17,17,17,17,18,18,18,18),breaks=c(1,2,6,11),name="Splice Event")+
scale_color_manual(values=c("blue","red","black","darkgreen","orange","purple","turquoise1"), name="Algorithm") +
scale_size_manual(labels=c("1-10X","10-100X","100X and more"),values=c(3,5,7),breaks=c(0,1,2),name="X coverage") +
theme(legend.position = "bottom") + ggtitle("With Gene Models (TopHat2)")+ scale_y_continuous(limits=c(-0.01, 1.01)) + scale_x_continuous(limits=c(-0.1, 1.01)) +
guides(shape = guide_legend(override.aes = list(size=5)),color= guide_legend(override.aes = list(size=5)))
ggplot(d[d$NumOfSpliceforms %in% c(0:2) &
(d$GeneModels=="true") & d$Aligner == "Truth" & d$AlignmentGenomeGuided == "true",], aes(x=Precision , y=Recall)) +
geom_rect(aes(xmax=0.67,xmin=0,ymax=1,ymin=0),fill = rgb(1,.975,.975)) +
geom_rect(aes(xmax=1,xmin=0.67,ymax=0.25,ymin=0),fill = rgb(1,.975,.975)) +
facet_grid(. ~ DataSet) +
geom_vline(xintercept=seq(0.00, 1.00, by=0.25),color="gray86",size=.5) +
geom_hline(yintercept=seq(0.00, 1.00, by=0.25),color="gray86",size=.5)+
geom_vline(xintercept=seq(0.00, 1.00, by=1/8),color="gray86",size=.1) +
geom_hline(yintercept=seq(0.00, 1.00, by=1/8),color="gray86",size=.1)+
theme_bw()+
geom_jitter(aes(x=Precision , y=Recall, color=factor(Algorithm),size =factor(NumOfSpliceforms)), position = position_jitter(height = .008,width=.008),alpha=0.95) +
)
ggplot(d[d$NumOfSpliceforms %in% c(0:2) &
(d$GeneModels=="true") & d$Aligner == "Truth" & d$AlignmentGenomeGuided == "true",], aes(x=Precision , y=Recall)) +
geom_rect(aes(xmax=0.67,xmin=0,ymax=1,ymin=0),fill = rgb(1,.975,.975)) +
geom_rect(aes(xmax=1,xmin=0.67,ymax=0.25,ymin=0),fill = rgb(1,.975,.975)) +
facet_grid(. ~ DataSet) +
geom_vline(xintercept=seq(0.00, 1.00, by=0.25),color="gray86",size=.5) +
geom_hline(yintercept=seq(0.00, 1.00, by=0.25),color="gray86",size=.5)+
geom_vline(xintercept=seq(0.00, 1.00, by=1/8),color="gray86",size=.1) +
geom_hline(yintercept=seq(0.00, 1.00, by=1/8),color="gray86",size=.1)+
theme_bw()+
geom_jitter(aes(x=Precision , y=Recall, color=factor(Algorithm),size =factor(NumOfSpliceforms)), position = position_jitter(height = .008,width=.008),alpha=0.95) +
#scale_shape_manual(labels=c("0-10X","10-100X","100X and more"),values=c(15,16,16,16,16,17,17,17,17,18,18,18,18),breaks=c(1,2,6,11),name="Splice Event")+
scale_color_manual(values=c("blue","red","black","darkgreen","orange","purple","turquoise1"), name="Algorithm: ") +
scale_size_manual(labels=c("1-10X","10-100X","100X and more"),values=c(4,6,8),breaks=c(0,1,2),name="X coverage: ") +
theme(legend.position = "bottom") + ggtitle("With Gene Models (Truth)")+ scale_y_continuous(limits=c(-0.01, 1.01)) + scale_x_continuous(limits=c(-0.1, 1.01)) +
guides(shape = guide_legend(override.aes = list(size=7)),color= guide_legend(override.aes = list(size=7)))+ theme(text = element_text(size=20))
ggplot(d[d$NumOfSpliceforms %in% c(0:2) &
(d$GeneModels=="true") & d$Aligner == "Truth" ,], aes(x=Precision , y=Recall)) +
geom_rect(aes(xmax=0.67,xmin=0,ymax=1,ymin=0),fill = rgb(1,.975,.975)) +
geom_rect(aes(xmax=1,xmin=0.67,ymax=0.25,ymin=0),fill = rgb(1,.975,.975)) +
facet_grid(. ~ DataSet) +
geom_vline(xintercept=seq(0.00, 1.00, by=0.25),color="gray86",size=.5) +
geom_hline(yintercept=seq(0.00, 1.00, by=0.25),color="gray86",size=.5)+
geom_vline(xintercept=seq(0.00, 1.00, by=1/8),color="gray86",size=.1) +
geom_hline(yintercept=seq(0.00, 1.00, by=1/8),color="gray86",size=.1)+
theme_bw()+
geom_jitter(aes(x=Precision , y=Recall, color=factor(Algorithm),size =factor(NumOfSpliceforms)), position = position_jitter(height = .008,width=.008),alpha=0.95) +
#scale_shape_manual(labels=c("0-10X","10-100X","100X and more"),values=c(15,16,16,16,16,17,17,17,17,18,18,18,18),breaks=c(1,2,6,11),name="Splice Event")+
scale_color_manual(values=c("blue","red","black","darkgreen","orange","purple","turquoise1"), name="Algorithm: ") +
scale_size_manual(labels=c("1-10X","10-100X","100X and more"),values=c(4,6,8),breaks=c(0,1,2),name="X coverage: ") +
theme(legend.position = "bottom") + ggtitle("With Gene Models (Truth)")+ scale_y_continuous(limits=c(-0.01, 1.01)) + scale_x_continuous(limits=c(-0.1, 1.01)) +
guides(shape = guide_legend(override.aes = list(size=7)),color= guide_legend(override.aes = list(size=7)))+ theme(text = element_text(size=20))
cols <- c('character','character','character','character','character', 'integer','integer','integer','character',
'numeric','numeric', 'character')
d = read.csv("results_combined.txt",header = T,sep = "\t",na.strings = "NaN",colClasses = cols)
d$DataSet[d$DataSet == "EnsemblDirty"] = "EnsemblRealistic"
d$DataSet[d$DataSet == "EnsemblClean"] = "EnsemblPerfect"
d[d$NumOfSpliceforms %in% c(0:2) &
(d$GeneModels=="true") & d$Aligner == "Truth" ,]
cols <- c('character','character','character','character','character', 'integer','integer','integer','character',
'numeric','numeric', 'character')
d = read.csv("results_combined.txt",header = T,sep = "\t",na.strings = "NaN",colClasses = cols)
d$DataSet[d$DataSet == "EnsemblDirty"] = "EnsemblRealistic"
d$DataSet[d$DataSet == "EnsemblClean"] = "EnsemblPerfect"
ggplot(d[d$NumOfSpliceforms %in% c(0:2) &
(d$GeneModels=="true") & d$Aligner == "Truth" ,], aes(x=Precision , y=Recall)) +
geom_rect(aes(xmax=0.67,xmin=0,ymax=1,ymin=0),fill = rgb(1,.975,.975)) +
geom_rect(aes(xmax=1,xmin=0.67,ymax=0.25,ymin=0),fill = rgb(1,.975,.975)) +
facet_grid(. ~ DataSet) +
geom_vline(xintercept=seq(0.00, 1.00, by=0.25),color="gray86",size=.5) +
geom_hline(yintercept=seq(0.00, 1.00, by=0.25),color="gray86",size=.5)+
geom_vline(xintercept=seq(0.00, 1.00, by=1/8),color="gray86",size=.1) +
geom_hline(yintercept=seq(0.00, 1.00, by=1/8),color="gray86",size=.1)+
theme_bw()+
geom_jitter(aes(x=Precision , y=Recall, color=factor(Algorithm),size =factor(NumOfSpliceforms)), position = position_jitter(height = .008,width=.008),alpha=0.95) +
#scale_shape_manual(labels=c("0-10X","10-100X","100X and more"),values=c(15,16,16,16,16,17,17,17,17,18,18,18,18),breaks=c(1,2,6,11),name="Splice Event")+
scale_color_manual(values=c("blue","red","black","darkgreen","orange","purple","turquoise1"), name="Algorithm: ") +
scale_size_manual(labels=c("1-10X","10-100X","100X and more"),values=c(4,6,8),breaks=c(0,1,2),name="X coverage: ") +
theme(legend.position = "bottom") + ggtitle("With Gene Models (Truth)")+ scale_y_continuous(limits=c(-0.01, 1.01)) + scale_x_continuous(limits=c(-0.1, 1.01)) +
guides(shape = guide_legend(override.aes = list(size=7)),color= guide_legend(override.aes = list(size=7)))+ theme(text = element_text(size=20))
setwd("/Users/kat/github/aligner_benchmark/rscripts")
cols <- c('character','character','character','character','character','character',
'numeric')
d = read.csv("../test_file", head =T,sep = "\t", colClasses = cols)
ggplot(d, aes(x = algorithm, y= value),stat="identity") +
geom_bar(stat="identity",fill=factor(d$replicate))
library(ggplot2)
library(tidyr)
cols <- c('character','character','character','character','character','character',
'numeric')
d = read.csv("../test_file", head =T,sep = "\t", colClasses = cols)
ggplot(d, aes(x = algorithm, y= value),stat="identity") +
geom_bar(stat="identity",fill=factor(d$replicate))
ggplot(d, aes(x = algorithm, y= value,fill=factor(d$replicate)),stat="identity") +
geom_bar(stat="identity")
cols <- c('character','character','character','character','character','character',
'numeric')
d = read.csv("../test_file", head =T,sep = "\t", colClasses = cols)
ggplot(d, aes(x = algorithm, y= value,fill=factor(d$replicate)),stat="identity") +
geom_bar(stat="identity",position="dodge")
